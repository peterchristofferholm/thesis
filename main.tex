\PassOptionsToPackage{full}{textcomp}
\documentclass[a4paper, twoside, nobib]{tufte-book}
\hypersetup{colorlinks}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% metadata

\title{ML-based precision medicine in ischemic heart disease}
\author[Peter Christoffer Holm]{Peter Christoffer Holm}
\publisher{%
    Graduate School of Health and Medical Sciences
    University of Copenhagen%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% biblatex configuration

\usepackage[%
    style=verbose-note,
    %% disable these fields in the citation %%
    url=false,
    isbn=false,
    doi=false,
    eprint=false,
    eprint=false,
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    date=year,
    maxcitenames=2,     % when should "et al." be triggered?
    maxbibnames=4,      % when should "et al." be triggered? (in bib)
    sorting=nty,        % name, title, year
    autocite=footnote,  % put citation in sidenotes 
    citereset=chapter,  % reset citation tracker at each chapter
    citetracker=strict,
    trackfloats=true
]{biblatex}

\DeclareCiteCommand{\cite}
  {\usebibmacro{prenote}}
  {\usebibmacro{citeindex}%
   \usebibmacro{footcite}}
  {\multicitedelim}
  {\usebibmacro{cite:postnote}}

\newcommand{\sidecite}[2][0em]{%
	\unskip\sidenote[][#1]{\cite{#2}}%
}

\renewbibmacro{in:}{}
\AtEveryCitekey{%
    \clearfield{pagetotal}%
    \clearfield{eprint}%
    \clearfield{url}%
    \clearfield{pages}%
    \clearfield{series}%
    \clearfield{volume}%
    \clearfield{number}%
    \clearfield{issue}%
    \clearlist{location}%
    \clearname{editor}%
}
\addbibresource{assets/pch-thesis.bib}

% fix appearance of cited preprints
\DeclareSourcemap{
    \maps[datatype=bibtex]{
        \map{
            \pertype{online}
            \step[typesource=online, typetarget=article]
            \step[fieldsource=eprinttype, fieldtarget=journaltitle]
            \step[fieldsource=journaltitle,
                match={arxiv}, replace={arXiv}]
        }
    }
}

\DeclareStyleSourcemap{
    \maps[datatype=bibtex]{
        \map{
            \pertype{inproceedings}
            \step[fieldset=publisher, null=true]
        }
    }
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% load packages

% fonts
\usepackage[T1]{fontenc}

\usepackage[p, osf]{ETbb}  % osf in text, tabular lining figures in math
\usepackage[scaled=.95,type1]{cabin}  % sans serif in style of Gill Sans
\usepackage[libertine, vvarbb]{newtxmath}

% misc
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{microtype}
\usepackage{booktabs}
\usepackage{tabularx}
\usepackage{multicol}
\usepackage{makecell}
\usepackage{pdfpages}
\usepackage{appendix}
\usepackage{siunitx}
\usepackage{todonotes}

\usepackage{subcaption}
\captionsetup{font=footnotesize}    


\usepackage{marginfix}
\usepackage{appendix}
\usepackage{twemojis}
\usepackage{cleveref}
\usepackage{pgffor}
\usepackage{relsize}  % easy scaling of fonts
\usepackage{bm}

%\newcommand{\mbf}[1]{\bm{\mathrm{#1}}}
\DeclareMathOperator{\EX}{\mathbb{E}} % expected value
\DeclareMathOperator{\PR}{\mathbb{P}} % probability 
\DeclareMathOperator{\I}{\mathbb{1}}  % indicator 
\DeclareMathOperator{\CIF}{CIF}
\DeclareMathOperator{\card}{\raisebox{-.22ex}{\#}}



\DeclareMathOperator*{\argmin}{arg\,min}
\newcommand{\diff}{\mathrm{d}}

\newcommand{\xa}{\mathbf{x}}
\newcommand{\xb}{\check{\xa}}
\newcommand{\hzt}{\lambda_0\mspace{-1mu}(t)}

% enumerate
\usepackage[inline]{enumitem}
\renewlist{enumerate*}{enumerate*}{1}
\setlist[enumerate*]{
    label=(\roman*), itemjoin={{; }}, itemjoin*={{; and }}
}

% context aware quotation marks
\usepackage{csquotes}  
\renewcommand{\mkcitation}[1]{~\autocite{#1}}

% acro 
\usepackage[nohyperlinks]{acronym}
%\renewcommand*{\acsfont}[1]{{\relsize{+0.5}\smallcaps{#1}}}

% tikz 
\usepackage{tikz}
\usepackage{pgfplots}
\usepgfplotslibrary{groupplots}
\usepackage{listofitems}
\usepackage{contour}
% \usetikzlibrary{external}
% \tikzexternalize[optimize=false, prefix=figures/]

\usetikzlibrary{positioning}
\usetikzlibrary{arrows,shapes}
\usetikzlibrary{arrows.meta} 
\usetikzlibrary{graphs} 
\usetikzlibrary{quotes} 
\usetikzlibrary{decorations.text}
\usetikzlibrary{decorations.markings}
\usepackage{annotate-equations}

\definecolor{color0}{HTML}{001118}
\definecolor{color1}{HTML}{005e72}
\definecolor{color2}{HTML}{0a9395}
\definecolor{color3}{HTML}{93d1bc}
\definecolor{color4}{HTML}{e8d8a5}
\definecolor{color5}{HTML}{ed9a00}
\definecolor{color6}{HTML}{ca6702}
\definecolor{color7}{HTML}{ba3d02}
\definecolor{color8}{HTML}{ae1f11}
\definecolor{color9}{HTML}{9a2126}

% for graphics / images
\usepackage{graphicx}
\setkeys{Gin}{width=\linewidth,totalheight=\textheight,keepaspectratio}
\graphicspath{{graphics/}}

% adjust verbatim environments
\usepackage{fancyvrb}
\fvset{fontsize=\normalsize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% custom macros

% Hanging parentheses and asterisks
\newcommand{\hangp}[1]{\makebox[0pt][r]{(}#1\makebox[0pt][l]{)}}
\newcommand{\hangstar}{\makebox[0pt][l]{*}}

% prints the month name (e.g., january) and the year (e.g., 2008)
\newcommand{\monthyear}{%
  \ifcase\month\or January\or February\or March\or April\or May\or June\or
  July\or August\or September\or October\or November\or
  December\fi\space\number\year
}

% misc
\newcommand{\na}{\quad--}
\newcommand{\blankpage}{\newpage\hbox{}\thispagestyle{empty}\newpage}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

\frontmatter
\maketitle

\include{content/00-copyright}      % [ ]
\include{content/00-preface}        % [ ]

\cleardoublepage
\tableofcontents
\listoffigures
\listoftables

\include{content/00-acronyms}        % [ ]
\include{content/01-manuscripts}     % [ ]
\include{content/01-summary}         % [ ]

\cleardoublepage
\include{content/overview}           % [ ]

\mainmatter %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\part{Background and Methods}
\include{content/introduction}       % [X]
\include{content/machine-learning}   % [X]
\include{content/survival-analysis}  % [ ]

\part{Outline of Papers}
\include{content/data-foundation}    % [ ]
\include{content/results-paper1}     % [ ]
\include{content/results-paper2}     % [ ]
\include{content/results-paper3}     % [ ]
\include{content/conclusions}        % [ ]

\include{content/miscellaneous.tex}

\backmatter %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\addcontentsline{toc}{chapter}{List of References}
\printbibliography

\mainmatter %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\appendix
\appendixpage
\addappheadtotoc
\cleardoublepage

\includepdf[
    clip, trim=1cm 4cm 1cm 1.8cm, offset=0 -2.2cm, 
    frame=true, scale=0.8, 
    pages=1, pagecommand=\chapter{Paper 1}\label{chap:paper-1}]%
    {assets/paper1-clustering.pdf}
% \includepdf[
%     clip, trim=1cm 0 1cm 1.5cm, offset=0 0, 
%     frame=true, scale=0.8, 
%     pages=2-, pagecommand={}]%
%     {assets/paper1-clustering.pdf}

\cleardoublepage
\includepdf[
    clip, trim=1cm 4cm 1cm 1.8cm, offset=0 -2.2cm, 
    frame=true, scale=0.8, 
    pages=1, pagecommand=\chapter{Paper 2}\label{chap:paper-2}]%
    {assets/paper1-clustering.pdf}

\cleardoublepage
\includepdf[
    clip, trim=1cm 4cm 1cm 1.8cm, offset=0 -2.2cm, 
    frame=true, scale=0.8, 
    pages=1, pagecommand=\chapter{Paper 3}\label{chap:paper-3}]%
    {assets/paper1-clustering.pdf}

\end{document}
